<!DOCTYPE html>
<html lang="en">
<!-- TABULA VERSION: ask for it on the console. -->
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/img/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/img/favicon.ico" type="image/x-icon">

    <title>TKTK | Tabula</title>

    <!-- Bootstrap core CSS -->
    <link href="/css/styles.css" rel="stylesheet">

    <!-- Selector-specific CSS -->
    <link href="/css/selectors.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <script type="text/javascript" src="/js/vendor/jquery.min.js"></script>
    <script type="text/javascript" src="/js/vendor/underscore-min.js"></script>
    <script type="text/javascript" src="/js/vendor/backbone-min.js"></script>
    <script type="text/javascript" src="/js/vendor/bootstrap.js"></script>
  </head>


  <body data-spy="scroll" data-target=".nav.sidebar-nav" data-offset="0">
    <div class="ribbon-wrapper-green" id="dev-mode-ribbon" style="display: none;"><div class="ribbon-green">DEV mode</div></div>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <a class="navbar-brand" href="/">Tabula</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="/">My Files</a></li>
            <li><a href="/about" class="active">About</a></li> <!-- TODO: remember to add/remove the active class depending on whic hpage we're on. -->
            <li><a href="help">Help</a></li>
            <li><a href="https://github.com/tabulapdf/tabula">Source Code</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Mockup Pages <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
                <li><a href="mockup/import.html">Import</a></li> <!-- TODO: -->
                <li><a href="mockup/selections.html"> Make Selection(s)</a></li>
                <li><a href="mockup/export.html">Preview and Export</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>




    <div id="tabula"> <!-- TODO remember to change this ID to match what page we're on.  id="page-selections", id="page-export"-->   

    </div>


    <div id="templates">
      <script type="text/template" id="page-template" >
        <div class="page" id="page-div-<%= number %>">
          <img src="<%= image_url %>" draggable="false">
        </div>
      </script>
      <script type="text/template" id="thumbnail-template" >
        <a href="#page-<%= number %>"><img src="<%= image_url %>"></a>
        <div class="remove">
          <span class="glyphicon glyphicon-remove delete-page"></span>
          <!-- i title="rotate this page right" class="icon-repeat rotate-left"></i>
          <i title="rotate this page left" class="icon-repeat flip rotate-right"></i -->
        </div>
        <p><%= number %></p>
      </script>

      <script type="text/template" id="export-control-panel-template">
        <form id="download-form" action="/pdf/<%=pdf_id%>/data?format=csv" method="post">
          <div id="hidden-fields">
            <input type='hidden' class='data-query' name='coords' value='<%=list_of_coords%>' >
          </div>
          <label for="format">Export Format:</label>
          <select name="format" class="form-control">
            <option value="csv">CSV</option>
            <option value="tsv">TSV</option>
            <option value="json">JSON</option>
            <option value="json">ðŸ’©SV</option>
            <option value="xml">XML</option>
          </select>
          <a href="#"><button type="submit" id="download-data" class="btn btn-default" data-action='/pdf/<%=pdf_id%>/data?format=csv'>
            <span class="glyphicon glyphicon-download"></span>
            Export
          </button></a>
          <a href="#"><button type="button" id="copy-csv-to-clipboard" class="btn btn-default" <%=copyDisabled%> >
            <span class="glyphicon glyphicon-paperclip"></span>
             Copy to Clipboard
          </button></a>
        </form>
      </script>

      <script type="text/template" id="select-control-panel-template" >
        <a href="#"><button id="restore-detected-tables" type="button" class="btn btn-default" <%= show_restore_detected_tables %>><span class="glyphicon glyphicon-flash"></span> Autodetect Tables</button></a>
        <a href="#"><button type="button" id="clear-all-selections" class="btn btn-default" <%= disable_clear_all_selections %>><span class="glyphicon glyphicon-remove-circle"></span> Clear All Selections</button></a>
        <a href="#"><button type="button" id="all-data" class="btn btn-default" <%= disable_download_all %>><span class="glyphicon glyphicon-eye-open"></span> Preview & Export Extracted Data</button></a>
      </script>

      <script type="text/template" id="export-page-sidebar-template">
          <h4>Is the extracted data incorrect?</h4>

          <p>You can revise your selected cells or try an alternate extraction method.</p>

          <h5>Revise Selected Cells</h5>
          <p>Data has been extracted from the cells you selected in the previous step. You can revise your selection(s) to add or remove cells.</p>
          <p>
            <button type="button" class="btn btn-default" id="revise-selections"><span class="glyphicon glyphicon-arrow-left"></span> Revise selection(s)</button>
          </p>

          <h5>Choose Alternate Extraction Method</h5>

          <p>The current preview uses the <strong>Stream</strong> extraction method. If the data is not mapped to the correct cells, try the <strong>Lattice</strong> method instead.</p>

          <div class="btn-group" data-toggle="buttons-radio" id="extraction-method-btns" <%=disableExtractionMethodButtons%> >
            <button type="button" class="btn btn-default extraction-method-btn" disabled="disabled" data-method="original" ><span class="glyphicon glyphicon-th stream"></span> Stream</button>
            <button type="button" class="btn btn-default extraction-method-btn" data-method="spreadsheet"><span class="glyphicon glyphicon-th lattice"></span> Lattice</button>
          </div>

          <p>
            Stream looks for <em>whitespace</em> between columns, while Lattice looks for <em>boundary lines</em> between columns.
          </p>

         <h5>Still look wrong?</h5>
          <p><a href="http://www.github.com/tabulapdf/tabula/issues/new">Contact the developers</a> and tell us what you tried to do that didnâ€™t work.</p>
      </script>

      <!-- TODO: abstract out commonalities of select/export page templates -->
      <script type="text/template" id="export-page-template">
        <div id="sidebar">
        </div>

        <div id="main-pane">
            <div id="control-panel">
            </div>

           <h2>Preview of Extracted Tabular Data</h2>
            <div id="table-container">
              <table class="table table-bordered extracted-table">
                <tbody>
                <% _(data).each(function(row){ %>
                  <tr>
                    <% _(row).each(function(cell){ %>
                      <td><%= cell %></td>
                    <% }) %>
                  </tr>
                <% }) %>
                </tbody>
            </table>
            </div>
        </div>
      </script>

      <script type="text/template" id="pdf-view-template" >
        <div id="sidebar">
          <!-- thumbnails get rendered here by JS -->
        </div>
        <div id="main-pane">
          <div id="control-panel">
          </div>
 
          <div id="pages-container">
          </div>
        </div>
        <nestedscript type="text/javascript" src="/js/resizableSelection.js"></nestedscript> 
        <nestedscript type="text/javascript" src="/js/rectangularSelector.js"></nestedscript> 
        <nestedscript type="text/javascript" src="/js/vendor/ZeroClipboard.min.js"></nestedscript> 
      </script>

      <script type="text/template" id="navbar-template">
        <div class="navbar navbar-inverse navbar-fixed-top">
          <div class="navbar-inner">
            <div class="container-fluid">
              <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
              </a>
              <a class="brand" href="/"><strong>Tabula</strong> is experimental software</a>
              <div class="nav-collapse collapse">
                <ul class="nav">
                  <li><a href="/">Home</a></li>
                  <li><a href="#about" rel="popover" data-html="true" data-placement="bottom" data-content="<p><strong>Tabula</strong> is a tool to help liberate data tables trapped inside PDF files</p><br><p>It was created by <a href='http://jazzido.com' target='_blank'>Manuel AristarÃ¡n</a> with the help of <a href='http://propublica.org'>ProPublica</a>, <a href='http://blogs.lanacion.com.ar/data/'>La NaciÃ³n DATA</a> and <a href='http://www.mozillaopennews.org/'>Knight-Mozilla OpenNews</a></p>" data-title="What is <strong>Tabula</strong>?">About</a></li>
                </ul>

              </div><!--/.nav-collapse -->
            </div>
          </div>
        </div>
      </script>

      <script type="text/template" id="upload-template">
        <div class="container">
          <div class="jumbotron">
              <h4>Import one or more PDFs</h4>
              <form action="/upload" method="post" enctype="multipart/form-data" class="form-inline">

              <div class="input-group">
              <!-- we are using this here: http://www.abeautifulsite.net/whipping-file-inputs-into-shape-with-bootstrap-3/ -->
                  <span class="input-group-btn">
                      <span class="btn btn-primary btn-file">
                          Browse&hellip; <input type="file" id="file" name="file" multiple accept="application/pdf">
                      </span>
                  </span>
                  <input type="text" class="form-control" readonly>
              </div>
                 <button type="submit" class="btn btn-default">Import</button>
              </form>

              <h4><% if(importing){ %><em>Importingâ€¦</em><% }else{ %> Upload Progress<% } %></h4>
              <div class="progress">
                <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: <%= pct_complete %>%;"><span class="sr-only"> <%= pct_complete %>% Complete </span></div>
              </div>

              <hr>

              <h4>Imported PDFs</h4>

              <table class="table file-list tablesorter" id="fileTable">
                <thead>
                  <tr>
                    <th>File Name</th>
                    <th>Size</th>
                    <th>Pages</th>
                    <th>Date Added</th>
                    <th>Remove</th>
                    <th>Process</th>
                  </tr>
                </thead>
                <tbody id="uploaded-files-container">
                </tbody>
              </table>

          </div> <!-- /jumbotron -->
        </div> <!-- /container -->

        <!-- we are using this here: http://www.abeautifulsite.net/whipping-file-inputs-into-shape-with-bootstrap-3/ -->
        <nestedscript type="text/javascript" src="/js/vendor/upload-group.js"></nestedscript> 
        <nestedscript type="text/javascript" src="/js/vendor/jquery.tablesorter.min.js"></nestedscript>
      </script>

      <script type="text/template" id="uploaded-files-template">
          <% _(workspace).each(function(file){ %>
            <tr>
              <td><%= file['file'] %></td>
              <td>TK kB</td> <!-- TODO size -->
              <td>TK</td>     <!-- TODO page count -->
              <td><%= new Date(parseInt(file['time']) * 1000).toUTCString().slice(5, -7) %></td>
              <td><a href="#"><span class="glyphicon glyphicon-remove"></span></a></td>
              <td><a href="/pdf/<%= file['id'] %>"><button type="button" class="btn btn-sm btn-success">Extract Data</button></a></td>
            </tr>
          <% }) %>
      </script>

      <script type="text/template" id="upload-error-template" >
        <div class="container-fluid">
          <div class="row-fluid">
            <div class="span6 offset3">
              <div class="hero-unit">
                <h1>Tabula</h1>
                <h2>Upload Error</h2>
                <p><span id="message"><%= message %></span></p>
              </div> <!-- /hero-unit -->
            </div>
          </div>
        </div>
      </script>

    </div> <!-- /templates -->




    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->

    </script> <!-- TODO: move this to tabula.js, only run it if we're in upload page viewer -->

    <script type="text/javascript" src="/js/tabula.js"></script> <!-- actually starts Tabula -->

  </body>
</html>
